import{a as H}from"./chunk-7BWMHEMA.js";import{a as G,b as g,c as R,d as D,e as I,f as V,g as z,h as A,i as B}from"./chunk-IBUA52PN.js";import{G as P}from"./chunk-S32ZPM5K.js";import{e as L,k as M,l as k,o as T,r as N}from"./chunk-Q4CSJZBT.js";import{$ as p,Eb as _,Fa as a,Gb as l,Hb as b,Ub as y,Va as E,d as F,fb as d,ga as w,gb as u,ha as C,kb as h,lb as t,mb as n,na as f,nb as m,s as S,vb as x,xb as v}from"./chunk-B6KJMEWL.js";function U(r,i){if(r&1&&(t(0,"div",6),w(),t(1,"svg",26),m(2,"path",27),n(),C(),t(3,"span"),l(4),n()()),r&2){let o=v();a(4),b(o.errorMessage())}}function q(r,i){if(r&1&&(t(0,"span",12),l(1),n()),r&2){let o=v();a(),b(o.formUtils.getFieldError(o.loginForm,"email"))}}function W(r,i){if(r&1&&(t(0,"span",12),l(1),n()),r&2){let o=v();a(),b(o.formUtils.getFieldError(o.loginForm,"password"))}}function O(r,i){r&1&&(m(0,"span",28),l(1," Iniciando sesi\xF3n... "))}function J(r,i){r&1&&l(0," Iniciar Sesi\xF3n ")}var j=class r{fb=p(A);authService=p(P);router=p(M);googleLoading=f(!1);googleError=f("");loginForm;formUtils=H;loginTrigger=f(null);loginResource=N({params:()=>this.loginTrigger(),stream:({params:i})=>i?this.authService.login(i.email,i.password):S(null)});constructor(){this.loginForm=this.fb.group({email:["",[g.required,g.email]],password:["",[g.required,g.minLength(6)]]}),y(()=>{this.loginResource.hasValue()&&this.loginResource.value()&&(console.log("Login exitoso, navegando a /home"),this.router.navigate(["/home"]))})}onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}let{email:i,password:o}=this.loginForm.value;this.loginTrigger.set({email:i,password:o})}loading=this.loginResource.isLoading;errorMessage=()=>{let i=this.loginResource.error();if(!i)return"";let o=i.code||"";return{"auth/invalid-email":"El correo electr\xF3nico no es v\xE1lido","auth/user-disabled":"El usuario ha sido deshabilitado","auth/user-not-found":"No existe un usuario con este correo","auth/wrong-password":"Contrase\xF1a incorrecta","auth/invalid-credential":"Credenciales inv\xE1lidas"}[o]||"Error al iniciar sesi\xF3n"};get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}loginWithGoogle(){return F(this,null,function*(){if(!this.googleLoading()){this.googleLoading.set(!0),this.googleError.set("");try{yield this.authService.loginWithGoogle().toPromise(),this.router.navigate(["/home"])}catch(i){console.error(i),this.googleError.set("Error al iniciar sesi\xF3n con Google")}finally{this.googleLoading.set(!1)}}})}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=E({type:r,selectors:[["app-login-page"]],decls:40,vars:11,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-linear-to-br","from-primary","to-secondary","p-4"],[1,"card","w-full","max-w-md","bg-base-100","shadow-2xl"],[1,"card-body"],[1,"text-center","mb-6"],[1,"text-3xl","font-bold","text-primary","mb-2"],[1,"text-base-content/70"],[1,"alert","alert-error","mb-4"],[3,"ngSubmit","formGroup"],[1,"form-control","mb-6"],[1,"label"],[1,"label-text"],["type","email","formControlName","email","placeholder","ejemplo@correo.com",1,"input","input-bordered","w-full","placeholder:opacity-25"],[1,"block","text-red-500","text-sm","mt-1"],["type","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input","input-bordered","w-full","placeholder:opacity-25"],[1,"form-control","mt-6"],["type","submit",1,"btn","btn-primary","w-full",3,"disabled"],[1,"divider"],["type","button",1,"btn","btn-outline","w-full",3,"click","disabled"],["viewBox","0 0 24 24",1,"w-5","h-5"],["fill","currentColor","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"],["fill","currentColor","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","currentColor","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","currentColor","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],[1,"text-center","mt-4"],[1,"text-sm","text-base-content/70"],["routerLink","/register",1,"link","link-primary","font-semibold"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"loading","loading-spinner","loading-sm"]],template:function(o,e){if(o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),l(5,"\xA1Bienvenido!"),n(),t(6,"p",5),l(7,"Inicia sesi\xF3n para continuar"),n()(),d(8,U,5,1,"div",6),t(9,"form",7),x("ngSubmit",function(){return e.onSubmit()}),t(10,"div",8)(11,"label",9)(12,"span",10),l(13,"Correo electr\xF3nico"),n()(),m(14,"input",11),d(15,q,2,1,"span",12),n(),t(16,"div",8)(17,"label",9)(18,"span",10),l(19,"Contrase\xF1a"),n()(),m(20,"input",13),d(21,W,2,1,"span",12),n(),t(22,"div",14)(23,"button",15),d(24,O,2,0)(25,J,1,0),n()()(),t(26,"div",16),l(27,"O"),n(),t(28,"button",17),x("click",function(){return e.loginWithGoogle()}),w(),t(29,"svg",18),m(30,"path",19)(31,"path",20)(32,"path",21)(33,"path",22),n(),l(34," Continuar con Google "),n(),C(),t(35,"div",23)(36,"p",24),l(37," \xBFNo tienes cuenta? "),t(38,"a",25),l(39," Reg\xEDstrate aqu\xED "),n()()()()()()),o&2){let s,c;a(8),u(e.loginResource.error()?8:-1),a(),h("formGroup",e.loginForm),a(5),_("input-error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),a(),u((s=e.loginForm.get("email"))!=null&&s.invalid&&((s=e.loginForm.get("email"))!=null&&s.touched)?15:-1),a(5),_("input-error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),a(),u((c=e.loginForm.get("password"))!=null&&c.invalid&&((c=e.loginForm.get("password"))!=null&&c.touched)?21:-1),a(2),h("disabled",e.loading()||e.loginForm.invalid),a(),u(e.loading()?24:25),a(4),h("disabled",e.loading())}},dependencies:[L,B,I,G,R,D,V,z,T,k],encapsulation:2})};export{j as LoginPage};
